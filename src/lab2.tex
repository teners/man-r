\psection{Лабораторная работа №2}

\textbf{\large Корреляция. Статистическое оценивание.}

\textbf{Корреляция.}

\begin{enumerate}

    \item Смоделируйте 2 выборки из 100 значений нормально распределенной случайной величины. \\
          Для этого получите 100 случайных чисел от 0 до 1 с помощью функции \texttt{runif}.
          Затем, при помощи функции \texttt{qnorm}, которая первым аргументом принимает 
          набор [предварительно сгенерированных] вероятностей, необходимо получить две искомых выборки
          по одному и тому же набору вероятностей с различными значениями матожидания и среднего 
          квадратического отклонения.

          \begin{mdframed}[style=BadassFrame]

              \texttt{runif(num, low, high)} \\-- генерирует \texttt{num} случайных чисел в заданном интервале $[low; high]$  
              \begin{description}

                \item[num] -- количество чисел
                \item[low] -- нижняя граница интервала
                \item[high] -- верхняя граница интервала
              \end{description}
          \end{mdframed}

          \begin{mdframed}[style=BadassFrame]

              \texttt{qnorm(p, mean = 0, sd = 1, lower.tail = TRUE, log.p = FALSE)} \\
                -- вычисляет обратное значение функции нормального распределения по набору вероятностей
              \begin{description}

                \item[p] -- набор вероятностей
                \item[mean] -- (необязательный) матожидание случайной величины
                \item[sd] -- (необязательный) среднее квадратическое отклонение
                \item[lower.tail] -- (необязательный) если TRUE (по умолчанию), вероятности берутся в интервале $P[X \leq x]$. Иначе, $P[X > x]$ 
                \item[log.p] -- (необязательный) если TRUE, предполагается, что вероятности p даны как log(p)
              \end{description}
          \end{mdframed}

    \newpage

    \item Вычислите выборочный коэффициент корреляции для полученных выборок. Для вычисления 
          воспользуйтесь функцией \texttt{cor}. Достаточно использовать первые два аргумента.

          \begin{mdframed}[style=BadassFrame]

              \texttt{cor(x, y = NULL, use = ``everything'', \\ method = c(``pearson'', ``kendall'', ``spearman'')} \\
                -- вычисляет коэффициент корреляции двух наборов величин. 
              \begin{description}

                \item[x] -- первый набор
                \item[y] -- (необязательный) второй набор (аргумент по умолчанию эквивалентен y=x, но более эффективен )
                \item[use] -- (необязательный) метод вычисления коэффициента ковариации в случае отсутствия некоторых значений.
                    ``everything'' (по умолчанию), ``all.obs", ``complete.obs'', ``na.or.complete'', or ``pairwise.complete.obs''
                \item[method] -- (необязательный) способ вычисления коэффициента ковариации. Должен быть один из: 
                    ``pearson'' (по умолчанию), ``kendall'', ``spearman''
              \end{description}
          \end{mdframed}

    \item Вычислите выборочные коэффициенты корреляции для полученных выборок, используя функцию 
          \texttt{cov}. Достаточно использовать первые два аргумента.

          \begin{mdframed}[style=BadassFrame]

              \texttt{cov(x, y = NULL, use = ``everything'', \\ \indent method = c(``pearson'', ``kendall'', ``spearman''))} \\
                    -- вычисляет коэффициент ковариации двух наборов величин. 
              \begin{description}

                \item[x] -- первый набор
                \item[y] -- (необязательный) второй набор (аргумент по умолчанию эквивалентен y=x, но более эффективен )
                \item[use] -- (необязательный) метод вычисления коэффициента ковариации в случае отсутствия некоторых значений.
                    ``everything'' (по умолчанию), ``all.obs'', ``complete.obs'', ``na.or.complete'', or ``pairwise.complete.obs''
                \item[method] -- (необязательный) способ вычисления коэффициента ковариации. Должен быть один из: 
                    ``pearson'' (по умолчанию), ``kendall'', ``spearman''
              \end{description}
          \end{mdframed}

    \item Вычислите средние квадратические отклонения выборок с помощью функции \texttt{sd} и сравните
          с исходными значениями.


    \textbf{Точечная и интервальная оценки параметров распределения. Доверительные интервалы.}

    \item Смоделируйте выборку из 100 значений нормально распределенной случайной величины с помощью
          функции \texttt{rnorm}. Сохраните значения выбранных математического ожидания $\mu$ и 
          среднего квадратического отклонения $\sigma$. Также вычислите дисперсию на основании математического 
          ожидания.

    \item Вычислите дисперсию $S_x^2$ и среднее квадратическое отклонение $S_x$ выборки с помощью 
          функций \texttt{var} и \texttt{sd}. Сравните полученные значения с ранее использованными 
          $\sigma$ и $\sigma^2$.

          \begin{mdframed}[style=BadassFrame]

              \texttt{var(x, y = NULL, na.rm = FALSE, use)} \\ -- вычисляет дисперсию набора величин
              \begin{description}

                \item[x] -- первый набор
                \item[y] -- (необязательный) второй набор (аргумент по умолчанию эквивалентен y=x, но более эффективен )
                \item[na.rm] -- (необязательный) должны ли учитываться отсутствующие значения? (нет по умолчанию).
                \item[use] -- (необязательный) метод вычисления коэффициента ковариации в случае отсутствия некоторых значений.
                    ``everything'' (по умолчанию), ``all.obs", ``complete.obs'', ``na.or.complete'', or ``pairwise.complete.obs''
              \end{description}
          \end{mdframed}

          Достаточно использовать первый аргумент.

    \item Вычислите вероятность попадания случайной величины $X \in N(\mu, \sigma)$ в интервал $[5;11]$. Для нахождения значений функции распределения
          нормальной случайной величины $F(x)$ воспользуйтесь функцией \texttt{pnorm} соответствующим образом: $P\{5<X<11\}=F(11)-F(5)$.

          \begin{mdframed}[style=BadassFrame]

              \texttt{pnorm(q, mean = 0, sd = 1, lower.tail = TRUE, log.p = FALSE)} \\
                -- вычисляет результат функции нормального распределения
              \begin{description}

                \item[q] -- аргумент функции нормального распределения
                \item[mean] -- (необязательный) матожидание случайной величины
                \item[sd] -- (необязательный) среднее квадратическое отклонение
                \item[lower.tail] -- (необязательный) если TRUE (по умолчанию), вероятности берутся в интервале $P[X \leq x]$. Иначе, $P[X > x]$ 
                \item[log.p] -- (необязательный) если TRUE, предполагается, что вероятности p даны как log(p)
              \end{description}
          \end{mdframed}

    \item Получите случайную выборку на 10 элементов из вышеуказанной генеральной совокупности при помощи функции
          \texttt{sample}. Достаточно использовать первые два аргумента.

          \begin{mdframed}[style=BadassFrame]

              \texttt{sample(x, size, replace = FALSE, prob = NULL)} \\
                -- позволяет получить \texttt{size} случайных значений из набора \texttt{x}
              \begin{description}

                \item[x] -- входной набор значений
                \item[size] -- количество (положительное) случайных значений
                \item[replace] -- (необязательный) слудует ли выбирать с замещением элемента
                \item[prob] -- (необязательный) вектор значений вероятности выборки элементов из входного набора значений
              \end{description}
          \end{mdframed}

    \item Для данной выборки получите следующие значения: 

        \begin{itemize}

            \item[--] Выборочное среднее $\overline{x}$ - при помощи функции \texttt{mean}
            \item[--] Выборочная дисперсия $S_x^2$ - при помощи функции \texttt{var}
            \item[--] Выборочное среднее квадратичное отклонение $S_x$ - при помощи функции \texttt{sd}
        \end{itemize}

        \begin{mdframed}[style=BadassFrame]

              \texttt{mean(x)} \\ -- среднее значение среди элементов набора \texttt{x}
              \begin{description}

                \item[x] -- набор значений
              \end{description}
        \end{mdframed}

    \item Вычислите ошибки оценки параметров. Ошибка оценки равна разности истинного значения параметра 
          и его оценки: 
          $$ e_\mu = \mu - \overline{x} $$ 
          $$ e_\sigma = \sigma - S_x $$

    \item Найдите доверительный интервал дял оценки неизвестного математического ожидания с уровнем доверия 
          $ \beta = 1 - \alpha = 0.95 $, предполагая, что известно среднее квадратическое отклонение 
          генеральной совокупности $ \sigma $. \\
          Для этого вычислите значение $ t_{табл} $, входящее в формулу доверительного интервала при помощи функции 
          \texttt{qnorm} (в качестве $ \overline{x} $ укажите 0, а $ \sigma $ возьмите равной 1). При этом вероятность
          $ F(t) = P_r{X<t} $ (первый аргумент) стоит взять равной $ 0.975 $, это площадь под графиком плотности на 
          интервале $[-\infty;t]$.
          Далее вычислите границы интервала по формуле: 

          $$ \overline{x} - t_{табл} {\sigma \over \sqrt{n}} < \mu < \overline{x} + t_{табл} {\sigma \over \sqrt{n}} $$

    \item Постройте доверительный интервал для оценки математического ожидания при неизвестном значении генерального
          среднего квадратического отклонения по формуле:

          $$ \overline{x} - t_{табл} {S_x \over \sqrt{n-1}} < \mu < \overline{x} + t_{табл} {S_x \over \sqrt{n-1}} $$

          где $ S_x $ - среднее квадратическое отклонение, вычисленное выше, а $ t_{табл} $ находится при помощи 
          функции \texttt{qt} для уровня доверия $ 0.95 $ (в данном случае подставляется первым аргументом), 
          \texttt{n-1} степеней свободы (в нашем случае \texttt{n = 10}). 

          \begin{mdframed}[style=BadassFrame]

              \texttt{qt(p, df, ncp, lower.tail = TRUE, log.p = FALSE)} \\ -- возвращает значение функции распределения Стьюдента
              \begin{description}

                \item[p] -- набор вероятностей
                \item[df] -- число степеней свободы
                \item[ncp] -- (необязательный) параметр delta
                \item[lower.tail] -- (необязательный) если TRUE (по умолчанию), вероятности берутся в интервале $P[X \leq x]$. Иначе, $P[X > x]$ 
                \item[log.p] -- (необязательный) если TRUE, предполагается, что вероятности p даны как log(p)
              \end{description}
        \end{mdframed}


    \item Найдите доверительный интервал с уровнем доверия 0,95 для дисперсии при неизвестном значении генерального
          среднего по формуле:

          $$ {(n-1)S_x^2 \over t_2} \leq \sigma^2 \leq {(n-1)S_x^2 \over t_1} $$ 

          и для генерального среднего квадратического отклонения по формуле:

          $$ {\sqrt{n-1}S_x^2 \over \sqrt{t_2}} \leq \sigma \leq {\sqrt{n-1}S_x^2 \over \sqrt{t_1}} $$

          где $ S_x $ - среднее квадратичное отклонение, вычисленное выше, а $ t_2 $ находится при помощи
          функции \texttt{qchisq} (Распределение хи-квадрат) по заданному значению уровня доверия 0,025 при \texttt{n-1} степеней свободы.
          Аналогично $ t_2 $ находится по заданному значению уровня доверия 0,975.

          \begin{mdframed}[style=BadassFrame]

              \texttt{qchisq(p, df, ncp, lower.tail = TRUE, log.p = FALSE)} \\ -- возвращает значение функции распределения хи-квадрат
              \begin{description}

                \item[p] -- набор вероятностей
                \item[df] -- число степеней свободы
                \item[ncp] -- (необязательный) параметр delta
                \item[lower.tail] -- (необязательный) если TRUE (по умолчанию), вероятности берутся в интервале $P[X \leq x]$. Иначе, $P[X > x]$ 
                \item[log.p] -- (необязательный) если TRUE, предполагается, что вероятности p даны как log(p)
              \end{description}
        \end{mdframed}


\end{enumerate}



